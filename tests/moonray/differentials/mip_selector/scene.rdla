SceneVariables {
    ["image_width"] = 500,
    ["image_height"] = 300,
    ["pixel_samples"] = 3,
    ["max_depth"] = 1,
}

PerspectiveCamera("/Scene/rendering/camera") {
    ["node_xform"] = translate(0, -4, 26) * rotate(-15, 1, 0, 0) ,
}

key = RectLight("/Scene/lighting/key") {
    ["node_xform"] = rotate(-90, 1, 0, 0) * translate(0, 50, 19),
    ["intensity"] = 6,
    ["normalized"] = false,
    ["width"] = 40,
    ["height"] = 40,
}

lightSet = LightSet("LightSet") { key, }

sphereGeom1 = UsdGeometry("sphereGeom1") {
    ["node_xform"] = scale(0.5, 0.5, 0.5) * rotate(180, 0, 1, 0) * translate(0.0, 0.5, 19),
    ["stage"] = rats_assets_dir .. "/models/sphere.usdc",
    ["prim_path"] = "/sphere",
    ["mesh_resolution"] = 20,
}

sphereGeom2 = UsdGeometry("sphereGeom2") {
    ["node_xform"] = scale(0.7, 0.7, 0.7) * rotate(180, 0, 1, 0) * translate(-5.0, 0.4, 10.923),
    ["stage"] = rats_assets_dir .. "/models/sphere.usdc",
    ["prim_path"] = "/sphere",
}

sphereGeom3 = UsdGeometry("sphereGeom3") {
    ["node_xform"] = scale(0.7, 0.7, 0.7) * rotate(180, 0, 1, 0) * translate(-2.5, 0.4, 10.923),
    ["stage"] = rats_assets_dir .. "/models/sphere.usdc",
    ["prim_path"] = "/sphere",
}

sphereGeom4 = UsdGeometry("sphereGeom4") {
    ["node_xform"] = scale(0.7, 0.7, 0.7) * rotate(180, 0, 1, 0) * translate(0.0, 0.4, 10.923),
    ["stage"] = rats_assets_dir .. "/models/sphere.usdc",
    ["prim_path"] = "/sphere",
}

sphereGeom5 = UsdGeometry("sphereGeom5") {
    ["node_xform"] = scale(0.7, 0.7, 0.7) * rotate(180, 0, 1, 0) * translate(2.5, 0.4, 10.923),
    ["stage"] = rats_assets_dir .. "/models/sphere.usdc",
    ["prim_path"] = "/sphere",
}

sphereGeom6 = UsdGeometry("sphereGeom6") {
    ["node_xform"] = scale(0.7, 0.7, 0.7) * rotate(180, 0, 1, 0) * translate(5.0, 0.4, 10.923),
    ["stage"] = rats_assets_dir .. "/models/sphere.usdc",
    ["prim_path"] = "/sphere",
}

floorGeom = UsdGeometry("floorGeom") {
    ["node_xform"] = scale(30, 1.0, 30) * rotate(-45, 0, 1, 0),
    ["stage"] = rats_assets_dir .. "/models/plane.usdc",
    ["prim_path"] = "/plane",
}

GeometrySet("geometrySet") {
    sphereGeom1,
    sphereGeom2,
    sphereGeom3,
    sphereGeom4,
    sphereGeom5,
    sphereGeom6,
    floorGeom,
}

mipSelectorMap = ImageMap("mipSelectorMap") {
    ["texture"] = rats_assets_dir .. "/textures/mip_debug.exr",
    ["wrap around"] = false,
    ["mip_bias"] = -0.35,
}

sphereMtl1 = DwaSolidDielectricMaterial("sphereMtl1") {
    ["albedo"] = bind(mipSelectorMap),
    ["show_specular"] = false,
}

sphereMtl2 = DwaSolidDielectricMaterial("sphereMtl2") {
    ["show_diffuse"] = false,
    ["roughness"] = 0.0,
}

sphereMtl3 = DwaSolidDielectricMaterial("sphereMtl3") {
    ["show_diffuse"] = false,
    ["roughness"] = 0.1,
}

sphereMtl4 = DwaSolidDielectricMaterial("sphereMtl4") {
    ["show_diffuse"] = false,
    ["roughness"] = 0.3,
}

sphereMtl5 = DwaSolidDielectricMaterial("sphereMtl5") {
    ["show_diffuse"] = false,
    ["roughness"] = 0.5,
}

sphereMtl6 = DwaSolidDielectricMaterial("sphereMtl6") {
    ["show_specular"] = false,
}

floorMtl = DwaSolidDielectricMaterial("floorMtl") {
    ["albedo"] = bind(mipSelectorMap, Rgb(1, 1, 1)),
    ["show_specular"] = false,
}

Layer("layer") {
    { sphereGeom1, "", sphereMtl1, lightSet },
    { sphereGeom2, "", sphereMtl2, lightSet },
    { sphereGeom3, "", sphereMtl3, lightSet },
    { sphereGeom4, "", sphereMtl4, lightSet },
    { sphereGeom5, "", sphereMtl5, lightSet },
    { sphereGeom6, "", sphereMtl6, lightSet },
    { floorGeom,   "", floorMtl,   lightSet },
}
