rats_assets_dir = os.getenv("RATS_ASSETS_DIR")

SceneVariables {
    ["image_width"] = 256,
    ["image_height"] = 64,
    ["lights_visible_in_camera"] = true,
    ["volume_quality"] = 1,
}

OrthographicCamera("/Scene/rendering/camera") {
    ["node_xform"] = translate(0, 0, 10),
    ["film_width_aperture"] = 20,
}

sphere1 = UsdGeometry("/Scene/geometry/sphere1") {
    ["node_xform"] = translate(-10, 0, 0),
    ["stage"] = rats_assets_dir.."/models/sphere.usdc",
    ["prim_path"] = "/sphere",
}

sphere2 = UsdGeometry("/Scene/geometry/sphere2") {
    ["node_xform"] = translate(-8, 0, 0),
    ["stage"] = rats_assets_dir.."/models/sphere.usdc",
    ["prim_path"] = "/sphere",
}

sphere3 = UsdGeometry("/Scene/geometry/sphere3") {
    ["node_xform"] = translate(-6, 0, 0),
    ["stage"] = rats_assets_dir.."/models/sphere.usdc",
    ["prim_path"] = "/sphere",
}

sphere4 = UsdGeometry("/Scene/geometry/sphere4") {
    ["node_xform"] = translate(-4, 0, 0),
    ["stage"] = rats_assets_dir.."/models/sphere.usdc",
    ["prim_path"] = "/sphere",
}

sphere5 = UsdGeometry("/Scene/geometry/sphere5") {
    ["node_xform"] = translate(-2, 0, 0),
    ["stage"] = rats_assets_dir.."/models/sphere.usdc",
    ["prim_path"] = "/sphere",
}

sphere6 = UsdGeometry("/Scene/geometry/sphere6") {
    ["node_xform"] = translate(0, 0, 0),
    ["stage"] = rats_assets_dir.."/models/sphere.usdc",
    ["prim_path"] = "/sphere",
}

sphere7 = UsdGeometry("/Scene/geometry/sphere7") {
    ["node_xform"] = translate(2, 0, 0),
    ["stage"] = rats_assets_dir.."/models/sphere.usdc",
    ["prim_path"] = "/sphere",
}

sphere8 = UsdGeometry("/Scene/geometry/sphere8") {
    ["node_xform"] = translate(4, 0, 0),
    ["stage"] = rats_assets_dir.."/models/sphere.usdc",
    ["prim_path"] = "/sphere",
}

sphere9 = UsdGeometry("/Scene/geometry/sphere9") {
    ["node_xform"] = translate(6, 0, 0),
    ["stage"] = rats_assets_dir.."/models/sphere.usdc",
    ["prim_path"] = "/sphere",
}

sphere10 = UsdGeometry("/Scene/geometry/sphere10") {
    ["node_xform"] = translate(8, 0, 0),
    ["stage"] = rats_assets_dir.."/models/sphere.usdc",
    ["prim_path"] = "/sphere",
}

GeometrySet("geometryset") {
    sphere1,
    sphere2,
    sphere3,
    sphere4,
    sphere5,
    sphere6,
    sphere7,
    sphere8,
    sphere9,
    sphere10,
}

a1 = 0
baseVol1 = BaseVolume("/Scene/surfacing/baseVol1") {
    ["attenuation_color"] = Rgb(a1, a1, a1),
    ["diffuse_color"] = Rgb(0, 0, 0),
}

a2 = math.log(10/9)
baseVol2 = BaseVolume("/Scene/surfacing/baseVol2") {
    ["attenuation_color"] = Rgb(a2, a2, a2),
    ["diffuse_color"] = Rgb(0, 0, 0),
}

a3 = math.log(10/8)
baseVol3 = BaseVolume("/Scene/surfacing/baseVol3") {
    ["attenuation_color"] = Rgb(a3, a3, a3),
    ["diffuse_color"] = Rgb(0, 0, 0),
}

a4 = math.log(10/7)
baseVol4 = BaseVolume("/Scene/surfacing/baseVol4") {
    ["attenuation_color"] = Rgb(a4, a4, a4),
    ["diffuse_color"] = Rgb(0, 0, 0),
}

a5 = math.log(10/6)
baseVol5 = BaseVolume("/Scene/surfacing/baseVol5") {
    ["attenuation_color"] = Rgb(a5, a5, a5),
    ["diffuse_color"] = Rgb(0, 0, 0),
}

a6 = math.log(10/5)
baseVol6 = BaseVolume("/Scene/surfacing/baseVol6") {
    ["attenuation_color"] = Rgb(a6, a6, a6),
    ["diffuse_color"] = Rgb(0, 0, 0),
}

a7 = math.log(10/4)
baseVol7 = BaseVolume("/Scene/surfacing/baseVol7") {
    ["attenuation_color"] = Rgb(a7, a7, a7),
    ["diffuse_color"] = Rgb(0, 0, 0),
}

a8 = math.log(10/3)
baseVol8 = BaseVolume("/Scene/surfacing/baseVol8") {
    ["attenuation_color"] = Rgb(a8, a8, a8),
    ["diffuse_color"] = Rgb(0, 0, 0),
}

a9 = math.log(10/2)
baseVol9 = BaseVolume("/Scene/surfacing/baseVol9") {
    ["attenuation_color"] = Rgb(a9, a9, a9),
    ["diffuse_color"] = Rgb(0, 0, 0),
}

a10 = math.log(10/1)
baseVol10 = BaseVolume("/Scene/surfacing/baseVol10") {
    ["attenuation_color"] = Rgb(a10, a10, a10),
    ["diffuse_color"] = Rgb(0, 0, 0),
}

rect = RectLight("/Scene/lighting/rect") {
    ["node_xform"] = rotate(180, 1, 0, 0) * translate(0, 0, -10),
    ["normalized"] = false,
    ["width"] = 100,
    ["height"] = 100,
}

lightSet = LightSet("/Scene/lighting/lightSet") {
    rect,
}

Layer("/Scene/rendering/organizer/perPartitionAssignments") {
    {sphere1,  "", lightSet, baseVol1},  -- transmittance 1.0
    {sphere2,  "", lightSet, baseVol2},  -- transmittance 0.9
    {sphere3,  "", lightSet, baseVol3},  -- transmittance 0.8
    {sphere4,  "", lightSet, baseVol4},  -- transmittance 0.7
    {sphere5,  "", lightSet, baseVol5},  -- transmittance 0.6
    {sphere6,  "", lightSet, baseVol6},  -- transmittance 0.5
    {sphere7,  "", lightSet, baseVol7},  -- transmittance 0.4
    {sphere8,  "", lightSet, baseVol8},  -- transmittance 0.3
    {sphere9,  "", lightSet, baseVol9},  -- transmittance 0.2
    {sphere10, "", lightSet, baseVol10}, -- transmittance 0.1
}

