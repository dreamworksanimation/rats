rats_assets_dir = os.getenv("RATS_ASSETS_DIR")

SceneVariables {
    ["pixel_samples"] = 2,
    ["light_samples"] = 1,
    ["bsdf_samples"] = 1,
    ["bssrdf_samples"] = 0,
    ["max_depth"] = 0,
    ["russian_roulette_threshold"] = 0.0,
    ["image_width"] = 400,
    ["image_height"] = 250,
}

Camera("/Scene/rendering/camera") {
    ["node_xform"] = translate(0, 0, 1) * rotate(-15, 1, 0, 0) * translate(0, -0.12, 0),
    ["near"] = 0.1,
    ["far"] = 1000,
}

------------------------------------------------------------------------------

key = RectLight("/Scene/lighting/key") {
    ["node_xform"] = translate(0, 0, 10) * rotate(-90, 1, 0, 0),
    ["intensity"] = 250,
    ["normalized"] = false,
}

lightSet = LightSet("/Scene/lighting/lightSet") {
    key,
}

------------------------------------------------------------------------------

local floorGeom = UsdGeometry("/Scene/geometry/floor") {
    ["node_xform"] = rotate(-45, 0, 1, 0),
    ["stage"] = rats_assets_dir .. "/models/plane.usdc",
    ["prim_path"] = "/plane"
}

floorMap = ImageMap("/Scene/surfacing/color_grid") {
    ["texture"] = rats_assets_dir .. "/textures/color_grid_8bit.tx",
    ["wrap_around"] = false,
}

local floorMtl = DwaBaseMaterial("/Scene/surfacing/floor") {
    ["albedo"] = bind(floorMap, Rgb(1, 1, 1)),
    ["specular"] = 0,
}

------------------------------------------------------------------------------

GeometrySet("Scene/geometrySet") {
    floorGeom
}

Layer("/Scene/layer") {
    {floorGeom, "", floorMtl, lightSet}
}
