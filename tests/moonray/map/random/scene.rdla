rats_assets_dir = os.getenv("RATS_ASSETS_DIR")

SceneVariables {
    ["image_width"] = 400,
    ["image_height"] = 400,
    ["pixel_samples"] = 2,
    ["lights_visible_in_camera"] = true,
}

Camera("/Scene/rendering/camera") {
    ["node_xform"] = translate(0,0,15),
}

-------------------------------------------------------

env = EnvLight("/Scene/lighting/env") {
    ["texture"] = rats_assets_dir.."/hdri/parkinglot_dusk.exr",
}

lightSet = LightSet("/Scene/lighting/lightSet") {
    env,
}

-------------------------------------------------------

box1 = BoxGeometry("/Scene/geometry/box1") {}

sphere1 = SphereGeometry("/Scene/geometry/sphere1") {}

primvar_a = UserData("primvar_a") {
    ["color_key"] = "primvar_a",
    ["color_values_0"] = {Rgb(1,2,4),
                          Rgb(8,16,32),
                          Rgb(64,128,256),
                          Rgb(512,1024,2048),
                          Rgb(4096, 8192, 16384),
                          Rgb(32768,65536,131072),                     
                          Rgb(262144,524288,1048576),
                          Rgb(2097142,4194304,8308688),
                          Rgb(16777216,33554432,16777216)},
}

instancer1 = RdlInstancerGeometry("instancer1") {
    ["references"] = {sphere1},
    ["positions"] = {Vec3(-3.0, 3.0, 0.0),Vec3(-3.0, 0.0, 0.0),Vec3(-3.0,-3.0, 0.0),
                     Vec3( 0.0, 3.0, 0.0),Vec3( 0.0, 0.0, 0.0),Vec3( 0.0,-3.0, 0.0),
                     Vec3( 3.0, 3.0, 0.0),Vec3( 3.0, 0.0, 0.0),Vec3( 3.0,-3.0, 0.0)},
    ["primitive_attributes"] = {primvar_a},
}

GeometrySet("geometryset") {
    instancer1,
    sphere1,
    box1,
}

----------------------------------------------------------

map_a = AttributeMap("map_a") {
   ["primitive_attribute_name"] = "primvar_a",
   ["default_value"] = Rgb(1.0, 0.0, 1.0),
}

map_r = RandomMap("map_r") {
    ["input"] = bind(map_a),
    ["monochrome"] = false,
}

base = DwaBaseMaterial("/Scene/surfacing/base2") {
    ["albedo"] = bind(map_r),
    ["roughness"] = 0.3,
}

-------------------------------------------------------

Layer("/Scene/rendering/organizer/perPartitionAssignments") {
    {instancer1, "", lightSet},
    {sphere1, "", base, lightSet},
    {box1, "", base, lightSet},

}
