rats_assets_dir = os.getenv("RATS_ASSETS_DIR")

SceneVariables {
    ["pixel_samples"] = 1,
    ["light_samples"] = 0,
    ["max_depth"] = 0,
    ["image_width"] = 256,
    ["image_height"] = 480,
}

Camera("/Scene/rendering/camera") {
	["node_xform"] = translate(0, 6.73922, -15.4574),
}


-- Geometry --

lower = UsdGeometry("/Scene/geometry/lower") {
    ["node_xform"] = rotate(90, 1, 0, 0) * scale(10, 10, 10) * translate(0, 1.5, -30),
    ["stage"] = rats_assets_dir.."/models/plane.usdc",
    ["prim_path"] = "/plane"
}

upper = UsdGeometry("/Scene/geometry/upper") {
    ["node_xform"] = rotate(90, 1, 0, 0) * scale(10, 10, 10) * translate(0, 12, -30),
    ["stage"] = rats_assets_dir.."/models/plane.usdc",
    ["prim_path"] = "/plane"
}

GeometrySet("geometryset") {
    lower,
    upper,
}


-- Materials --

local immapCC = ImageMap("/Scene/surfacing/immapCC") {
    ["texture"] = rats_assets_dir.."/textures/color_grid.tx",
    ["saturation_enabled"] = true,
    ["saturation"] = Rgb(2.5, 2.5, 2.5),
    ["contrast_enabled"] = true,
    ["contrast"] = Rgb(2.5, 2.5, 2.5),
    ["gamma_enabled"] = true,
    ["gamma_adjust"] = Rgb(1.3, 1.3, 1.3),
    ["gain_offset_enabled"] = true,
    ["gain"] = Rgb(0.5, 0.5, 0.5),
    ["offset_adjust"] = Rgb(0.1, 0.1, 0.1),
    ["TME_control_enabled"] = true,
    ["TME"] = Vec3(-1.0, 1.0, 0.5),
}

local immap = ImageMap("/Scene/surfacing/immap") {
    ["texture"] = rats_assets_dir.."/textures/color_grid.tx",
}

local ccon = DwaEmissiveMaterial("/Scene/surfacing/ccon") {
    ["emission"] = bind(immapCC),
}

local ccdefaults = DwaEmissiveMaterial("/Scene/surfacing/ccdefaults") {
    ["emission"] = bind(immap),
}

local ls = LightSet("light_set")

Layer("/Scene/layer") {
    {lower, "", ccon, ls},
    {upper, "", ccdefaults, ls},
}
