rats_assets_dir = os.getenv("RATS_ASSETS_DIR")

SceneVariables {
    ["image_width"] = 300,
    ["image_height"] = 300,
    ["pixel_samples"] = 2,
    ["max_depth"] = 0,
}

PerspectiveCamera("camera") {
    ["node_xform"] = translate(0.0, 0.0, 5.0),
}

key = RectLight("/Scene/lighting/key") {
    ["node_xform"] = rotate(45, 1, 0, 0) * rotate(45, 0, 1, 0) * translate(5, 5, 5),
    ["intensity"] = 0.25,
}

lightSet = LightSet("lightSet") { key, }

geom = UsdGeometry("geom") {
    ["node_xform"] = scale(0.33, 0.33, 0.33) * rotate(15, 0, 1, 0) * translate(0, -1, -0),
    ["stage"] = rats_assets_dir .. "/models/MoonRayWidget.usdc",
    ["prim_path"] = "/widget",
}

GeometrySet("geomset") { geom, }

projCam = Camera("projCam") {
   ["node_xform"] = rotate(5, 1, 0, 0) * rotate(45, 0, 1, 0) * translate(5, 0, 5),
   ["focal"] = 100,
}

projNormalMap = ProjectCameraNormalMap("projNormalMap") {
    ["projector"] = projCam,
    ["texture"] = rats_assets_dir .. "/textures/chesterfield.tx",
    ["aspect_ratio_source"] = "custom",
    ["custom_aspect_ratio"] = 0.5,
}

mtl = DwaSolidDielectricMaterial("mtl") {
    ["input_normal"] = projNormalMap
}

Layer("layer") {
    { geom, "", mtl, lightSet },
}
