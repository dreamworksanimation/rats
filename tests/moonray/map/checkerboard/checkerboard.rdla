-- Simple test for checkerboard map shader using boxes
SceneVariables {
    ["pixel samples"] = 8,
    ["light samples"] = 0,
    ["bsdf samples"] = 0,
    ["bssrdf samples"] = 0,
    ["max depth"] = 0,
    ["image width"] = 256,
    ["image height"] = 256,
}

local shotCam = Camera("/Scene/rendering/camera") {
    ["node xform"] = rotate(-25.96, 1, 0 , 0) * rotate(24.86, 0, 1, 0) * translate(13.0, 12.0, 20.0), -- YXZ
}

-------------------------------------------------------

-- Geometry to checkerboard
local boxGeom1 = BoxGeometry("/Scene/geometry/boxGeom1") {
    ["node xform"] = rotate(-45, 1, 0, 0) *  translate(0.5, 1.0, 1.0) * scale(4.0, 4.0, 4.0),
    ["subd resolution"] = 2.0,
}

local boxGeom2 = BoxGeometry("/Scene/geometry/boxGeom2") {
    ["node xform"] = translate(2.5, 1.0, 1.0) * scale(4.0, 4.0, 4.0),
    ["subd resolution"] = 2.0,
}

local boxGeom3 = BoxGeometry("/Scene/geometry/boxGeom3") {
    ["node xform"] = rotate(-25, 0.1, 1, 0.1) * translate(0.5, -1.0, 1.0) * scale(4.0, 4.0, 4.0),
    ["subd resolution"] = 2.0,
}

local boxGeom3Proj = BoxGeometry("/Scene/geometry/boxGeom3Proj") {
    ["node xform"] = rotate(-65, 0, 1, 0) * translate(0.5, -1.0, 1.0) * scale(4.0, 4.0, 4.0),
    ["subd resolution"] = 2.0,
}

GeometrySet("Scene/geometrySet"){
    boxGeom1,
    boxGeom2,
    boxGeom3,
}

--------------------------------------------------------

local checkerMap1 = CheckerboardMap("/Scene/surfacing/checkerMap1") {
}

local checkerMap2 = CheckerboardMap("/Scene/surfacing/checkerMap2") {
    ["color A"] = Rgb(0.5, 0.5, 0.5),
    ["color B"] = Rgb(1.0, 1.0, 1.0),
    ["num u tiles"] = 24,
    ["num v tiles"] = 24
}

local projMap = ProjectPlanarMap("/Scene/surfacing/projMap") {
    ["projector"] = boxGeom3Proj
}

local checkerMap3 = CheckerboardMap("/Scene/surfacing/checkerMap3") {
    ["color A"] = Rgb(0.15, 0.15, 0.15),
    ["color B"] = Rgb(0.75, 0.75, 0.75),
    ["num u tiles"] = 2,
    ["num v tiles"] = 2,
    ["texture coordinates"] = 1,
    ["input texture coordinates"] = bind(projMap)
}

local mtl1 = DwaEmissiveMaterial("/Scene/surfacing/mtl1") {
    ["emission"] = bind(checkerMap1)
}

local mtl2 = DwaEmissiveMaterial("/Scene/surfacing/mtl2") {
    ["emission"] = bind(checkerMap2)
}

local mtl3 = DwaEmissiveMaterial("/Scene/surfacing/mtl3") {
    ["emission"] = bind(checkerMap3)
}

-------------------------------------------------------

local ls = LightSet("light_set")

Layer("/Scene/layer") {
    {boxGeom1, "", mtl1, ls},
    {boxGeom2, "", mtl2, ls},
    {boxGeom3, "", mtl3, ls},
}
