rats_assets_dir = os.getenv("RATS_ASSETS_DIR")

SceneVariables {
    ["image_width"] = 256,
    ["image_height"] = 256,
}

key = EnvLight("/Scene/lighting/key") {
   ["texture"] = rats_assets_dir.."/hdri/parkinglot.exr",
   ["visible_in_camera"] = 1
}

lightSet = LightSet("/Scene/lighting/lightSet") {
    key,
}

planeMtl = DwaSolidDielectricMaterial("/Scene/surfacing/planeMtl") {
    ["albedo"] = Rgb(0.5, 0.5, 0.5)
}

planeUvAtlas = UserData("/Scene/surfacing/planeUvAtlas") {
   ["vec2f_key"] = "uv_atlas",
   ["vec2f_values"] = {Vec2(0.0, 0.0),
    		       Vec2(0.75, 0.0),
    		       Vec2(0.75, 0.75),
    		       Vec2(0.0, 0.75)},
}

planeGeom = RdlMeshGeometry("/Scene/geometry/planeGeom") {
   ["vertex_list"] = {Vec3(-0.5, 0.0,  0.5),
		      Vec3( 0.5, 0.0,  0.5),
		      Vec3( 0.5, 0.0, -0.5),
		      Vec3(-0.5, 0.0, -0.5)},
   ["normal_list"] = {Vec3(0, 1, 0),
		      Vec3(0, 1, 0),
		      Vec3(0, 1, 0),
		      Vec3(0, 1, 0)},
   ["uv_list"] = {Vec2(0.0, 0.0),
		  Vec2(1.0, 0.0),
		  Vec2(1.0, 1.0),
		  Vec2(0.0, 1.0)},
   ["vertices_by_index"] = {0, 1, 2, 3},
   ["face_vertex_count"] = {4},
   ["is_subd"] = false,
   ["primitive_attributes"] = {planeUvAtlas},
}

triUvAtlas = UserData("/Scene/surfacing/triUvAtlas") {
   ["vec2f_key"] = "uv_atlas",
   ["vec2f_values"] = {Vec2(0.0, 0.0),
		       Vec2(1.0, 0.0),
		       Vec2(0.5, 1.0)},
}

triGeom = RdlMeshGeometry("/Scene/geometry/triGeom") {
   ["vertex_list"] = {Vec3(-0.5, 0.25,  0.5),
		      Vec3( 0.5, 0.25,  0.5),
		      Vec3(   0, 0.25, -0.5)},
   ["normal_list"] = {Vec3(0, 1, 0),
		      Vec3(0, 1, 0),
		      Vec3(0, 1, 0)},
   ["uv_list"] = {Vec2(0.0, 0.0),
		  Vec2(1.0, 0.0),
		  Vec2(0.5, 1.0)},
   ["vertices_by_index"] = {0, 1, 2},
   ["face_vertex_count"] = {3},
   ["is_subd"] = false,
   ["primitive_attributes"] = {triUvAtlas},
}

GeometrySet("Scene/geometrySet") {
    planeGeom,
    triGeom
}

Layer("/Scene/layer") {
    {planeGeom, "", planeMtl, lightSet},
    {triGeom, "", planeMtl, lightSet}
}

BakeCamera("/Scene/rendering/bakePlane") {
   ["node_xform"] = translate(0, .75, 3),
   ["geometry"] = planeGeom,
   ["mode"] = 0, -- camera
   ["bias"] = .001,
   ["near"] = .0001,
   ["far"] = 1,
   ["uv_attribute"] = "uv_atlas",
}

