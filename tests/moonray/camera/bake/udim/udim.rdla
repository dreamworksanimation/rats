rats_assets_dir = os.getenv("RATS_ASSETS_DIR")

SceneVariables {
    ["image_width"] = 256,
    ["image_height"] = 256,
}

key = EnvLight("/Scene/lighting/key") {
    ["texture"] = rats_assets_dir.."/hdri/parkinglot.exr",
    ["visible_in_camera"] = 1
}

lightSet = LightSet("/Scene/lighting/lightSet") {
    key,
}

checkerMap = ImageMap("/Scene/surfacing/checkerMap") {
    ["texture"] = rats_assets_dir.."/textures/udim/rgb_checker_black_<UDIM>.exr",
    ["wrap_around"] = false,
}

checkerMtl = DwaSolidDielectricMaterial("/Scene/surfacing/planeMtl") {
    ["albedo"] = bind(checkerMap)
}

vertList = {Vec3(-0.5,  0.0, 0.5),
            Vec3(-0.25, 0.0, 0.5),
            Vec3( 0.0,  0.0, 0.5),
            Vec3( 0.25, 0.0, 0.5),
            Vec3( 0.5,  0.0, 0.5),

            Vec3(-0.5,  0.0, 0.25),
            Vec3(-0.25, 0.0, 0.25),
            Vec3( 0.0,  0.0, 0.25),
            Vec3( 0.25, 0.0, 0.25),
            Vec3( 0.5,  0.0, 0.25),

            Vec3(-0.5,  0.0, 0.0),
            Vec3(-0.25, 0.0, 0.0),
            Vec3( 0.0,  0.0, 0.0),
            Vec3( 0.25, 0.0, 0.0),
            Vec3( 0.5,  0.0, 0.0),

            Vec3(-0.5,  0.0, -0.25),
            Vec3(-0.25, 0.0, -0.25),
            Vec3( 0.0,  0.0, -0.25),
            Vec3( 0.25, 0.0, -0.25),
            Vec3( 0.5,  0.0, -0.25),

            Vec3(-0.5,  0.0, -0.5),
            Vec3(-0.25, 0.0, -0.5),
            Vec3( 0.0,  0.0, -0.5),
            Vec3( 0.25, 0.0, -0.5),
            Vec3( 0.5,  0.0, -0.5)}

planeGeom = RdlMeshGeometry("/Scene/geometry/planeGeom") {
   ["vertex_list"] = vertList,
   ["vertices_by_index"] = {0, 1, 6, 5,
			    1, 2, 7, 6,
			    2, 3, 8, 7,
			    3, 4, 9, 8,

			    5, 6, 11, 10,
			    6, 7, 12, 11,
			    7, 8, 13, 12,
			    8, 9, 14, 13,

			    10, 11, 16, 15,
			    11, 12, 17, 16,
			    12, 13, 18, 17,
			    13, 14, 19, 18,

			    15, 16, 21, 20,
			    16, 17, 22, 21,
			    17, 18, 23, 22,
			    18, 19, 24, 23},

   ["normal_list"] = {Vec3(0.0, 1.0, 0.0), Vec3(0.0, 1.0, 0.0), Vec3(0.0, 1.0, 0.0), Vec3(0.0, 1.0, 0.0),
		      Vec3(0.0, 1.0, 0.0), Vec3(0.0, 1.0, 0.0), Vec3(0.0, 1.0, 0.0), Vec3(0.0, 1.0, 0.0),
		      Vec3(0.0, 1.0, 0.0), Vec3(0.0, 1.0, 0.0), Vec3(0.0, 1.0, 0.0), Vec3(0.0, 1.0, 0.0),
		      Vec3(0.0, 1.0, 0.0), Vec3(0.0, 1.0, 0.0), Vec3(0.0, 1.0, 0.0), Vec3(0.0, 1.0, 0.0),

		      Vec3(0.0, 1.0, 0.0), Vec3(0.0, 1.0, 0.0), Vec3(0.0, 1.0, 0.0), Vec3(0.0, 1.0, 0.0),
		      Vec3(0.0, 1.0, 0.0), Vec3(0.0, 1.0, 0.0), Vec3(0.0, 1.0, 0.0), Vec3(0.0, 1.0, 0.0),
		      Vec3(0.0, 1.0, 0.0), Vec3(0.0, 1.0, 0.0), Vec3(0.0, 1.0, 0.0), Vec3(0.0, 1.0, 0.0),
		      Vec3(0.0, 1.0, 0.0), Vec3(0.0, 1.0, 0.0), Vec3(0.0, 1.0, 0.0), Vec3(0.0, 1.0, 0.0),

		      Vec3(0.0, 1.0, 0.0), Vec3(0.0, 1.0, 0.0), Vec3(0.0, 1.0, 0.0), Vec3(0.0, 1.0, 0.0),
		      Vec3(0.0, 1.0, 0.0), Vec3(0.0, 1.0, 0.0), Vec3(0.0, 1.0, 0.0), Vec3(0.0, 1.0, 0.0),
		      Vec3(0.0, 1.0, 0.0), Vec3(0.0, 1.0, 0.0), Vec3(0.0, 1.0, 0.0), Vec3(0.0, 1.0, 0.0),
		      Vec3(0.0, 1.0, 0.0), Vec3(0.0, 1.0, 0.0), Vec3(0.0, 1.0, 0.0), Vec3(0.0, 1.0, 0.0),

		      Vec3(0.0, 1.0, 0.0), Vec3(0.0, 1.0, 0.0), Vec3(0.0, 1.0, 0.0), Vec3(0.0, 1.0, 0.0),
		      Vec3(0.0, 1.0, 0.0), Vec3(0.0, 1.0, 0.0), Vec3(0.0, 1.0, 0.0), Vec3(0.0, 1.0, 0.0),
		      Vec3(0.0, 1.0, 0.0), Vec3(0.0, 1.0, 0.0), Vec3(0.0, 1.0, 0.0), Vec3(0.0, 1.0, 0.0),
		      Vec3(0.0, 1.0, 0.0), Vec3(0.0, 1.0, 0.0), Vec3(0.0, 1.0, 0.0), Vec3(0.0, 1.0, 0.0)},

   ["uv_list"] = {Vec2(0.000001, 0.000001), Vec2(0.999999, 0.000001), Vec2(0.999999, 0.999999), Vec2(0.000001, 0.999999),
		  Vec2(1.000001, 0.000001), Vec2(1.999999, 0.000001), Vec2(1.999999, 0.999999), Vec2(1.000001, 0.999999),
		  Vec2(2.000001, 0.000001), Vec2(2.999999, 0.000001), Vec2(2.999999, 0.999999), Vec2(2.000001, 0.999999),
		  Vec2(3.000001, 0.000001), Vec2(3.999999, 0.000001), Vec2(3.999999, 0.999999), Vec2(3.000001, 0.999999),

		  Vec2(0.000001, 1.000001), Vec2(0.999999, 1.000001), Vec2(0.999999, 1.999999), Vec2(0.000001, 1.999999),
		  Vec2(1.000001, 1.000001), Vec2(1.999999, 1.000001), Vec2(1.999999, 1.999999), Vec2(1.000001, 1.999999),
		  Vec2(2.000001, 1.000001), Vec2(2.999999, 1.000001), Vec2(2.999999, 1.999999), Vec2(2.000001, 1.999999),
		  Vec2(3.000001, 1.000001), Vec2(3.999999, 1.000001), Vec2(3.999999, 1.999999), Vec2(3.000001, 1.999999),

		  Vec2(0.000001, 2.000001), Vec2(0.999999, 2.000001), Vec2(0.999999, 2.999999), Vec2(0.000001, 2.999999),
		  Vec2(1.000001, 2.000001), Vec2(1.999999, 2.000001), Vec2(1.999999, 2.999999), Vec2(1.000001, 2.999999),
		  Vec2(2.000001, 2.000001), Vec2(2.999999, 2.000001), Vec2(2.999999, 2.999999), Vec2(2.000001, 2.999999),
		  Vec2(3.000001, 2.000001), Vec2(3.999999, 2.000001), Vec2(3.999999, 2.999999), Vec2(3.000001, 2.999999),

		  Vec2(0.000001, 3.000001), Vec2(0.999999, 3.000001), Vec2(0.999999, 3.999999), Vec2(0.000001, 3.999999),
		  Vec2(1.000001, 3.000001), Vec2(1.999999, 3.000001), Vec2(1.999999, 3.999999), Vec2(1.000001, 3.999999),
		  Vec2(2.000001, 3.000001), Vec2(2.999999, 3.000001), Vec2(2.999999, 3.999999), Vec2(2.000001, 3.999999),
		  Vec2(3.000001, 3.000001), Vec2(3.999999, 3.000001), Vec2(3.999999, 3.999999), Vec2(3.000001, 3.999999)},

   ["face_vertex_count"] = {4, 4, 4, 4,
			    4, 4, 4, 4,
			    4, 4, 4, 4,
			    4, 4, 4, 4},
   ["is_subd"] = false,
}

triGeom = RdlMeshGeometry("/Scene/geometry/triGeom") {
   ["node_xform"] = translate(0.0, 0.2, 0.0),
   ["vertex_list"] = vertList,
   ["vertices_by_index"] = {0, 1, 6,
			    1, 2, 7,
			    2, 3, 8,
			    3, 4, 9,

			    5, 6, 11,
			    6, 7, 12,
			    7, 8, 13,
			    8, 9, 14,

			    10, 11, 16,
			    11, 12, 17,
			    12, 13, 18,
			    13, 14, 19,

			    15, 16, 21,
			    16, 17, 22,
			    17, 18, 23,
			    18, 19, 24},

   ["normal_list"] = {Vec3(0.0, 1.0, 0.0), Vec3(0.0, 1.0, 0.0), Vec3(0.0, 1.0, 0.0),
		      Vec3(0.0, 1.0, 0.0), Vec3(0.0, 1.0, 0.0), Vec3(0.0, 1.0, 0.0),
		      Vec3(0.0, 1.0, 0.0), Vec3(0.0, 1.0, 0.0), Vec3(0.0, 1.0, 0.0),
		      Vec3(0.0, 1.0, 0.0), Vec3(0.0, 1.0, 0.0), Vec3(0.0, 1.0, 0.0),

		      Vec3(0.0, 1.0, 0.0), Vec3(0.0, 1.0, 0.0), Vec3(0.0, 1.0, 0.0),
		      Vec3(0.0, 1.0, 0.0), Vec3(0.0, 1.0, 0.0), Vec3(0.0, 1.0, 0.0),
		      Vec3(0.0, 1.0, 0.0), Vec3(0.0, 1.0, 0.0), Vec3(0.0, 1.0, 0.0),
		      Vec3(0.0, 1.0, 0.0), Vec3(0.0, 1.0, 0.0), Vec3(0.0, 1.0, 0.0),

		      Vec3(0.0, 1.0, 0.0), Vec3(0.0, 1.0, 0.0), Vec3(0.0, 1.0, 0.0),
		      Vec3(0.0, 1.0, 0.0), Vec3(0.0, 1.0, 0.0), Vec3(0.0, 1.0, 0.0),
		      Vec3(0.0, 1.0, 0.0), Vec3(0.0, 1.0, 0.0), Vec3(0.0, 1.0, 0.0),
		      Vec3(0.0, 1.0, 0.0), Vec3(0.0, 1.0, 0.0), Vec3(0.0, 1.0, 0.0),

		      Vec3(0.0, 1.0, 0.0), Vec3(0.0, 1.0, 0.0), Vec3(0.0, 1.0, 0.0),
		      Vec3(0.0, 1.0, 0.0), Vec3(0.0, 1.0, 0.0), Vec3(0.0, 1.0, 0.0),
		      Vec3(0.0, 1.0, 0.0), Vec3(0.0, 1.0, 0.0), Vec3(0.0, 1.0, 0.0),
		      Vec3(0.0, 1.0, 0.0), Vec3(0.0, 1.0, 0.0), Vec3(0.0, 1.0, 0.0)},

   ["uv_list"] = {Vec2(0.000001, 0.000001), Vec2(0.999999, 0.000001), Vec2(0.999999, 0.999999),
		  Vec2(1.000001, 0.000001), Vec2(1.999999, 0.000001), Vec2(1.999999, 0.999999),
		  Vec2(2.000001, 0.000001), Vec2(2.999999, 0.000001), Vec2(2.999999, 0.999999),
		  Vec2(3.000001, 0.000001), Vec2(3.999999, 0.000001), Vec2(3.999999, 0.999999),

		  Vec2(0.000001, 1.000001), Vec2(0.999999, 1.000001), Vec2(0.999999, 1.999999),
		  Vec2(1.000001, 1.000001), Vec2(1.999999, 1.000001), Vec2(1.999999, 1.999999),
		  Vec2(2.000001, 1.000001), Vec2(2.999999, 1.000001), Vec2(2.999999, 1.999999),
		  Vec2(3.000001, 1.000001), Vec2(3.999999, 1.000001), Vec2(3.999999, 1.999999),

		  Vec2(0.000001, 2.000001), Vec2(0.999999, 2.000001), Vec2(0.999999, 2.999999),
		  Vec2(1.000001, 2.000001), Vec2(1.999999, 2.000001), Vec2(1.999999, 2.999999),
		  Vec2(2.000001, 2.000001), Vec2(2.999999, 2.000001), Vec2(2.999999, 2.999999),
		  Vec2(3.000001, 2.000001), Vec2(3.999999, 2.000001), Vec2(3.999999, 2.999999),

		  Vec2(0.000001, 3.000001), Vec2(0.999999, 3.000001), Vec2(0.999999, 3.999999),
		  Vec2(1.000001, 3.000001), Vec2(1.999999, 3.000001), Vec2(1.999999, 3.999999),
		  Vec2(2.000001, 3.000001), Vec2(2.999999, 3.000001), Vec2(2.999999, 3.999999),
		  Vec2(3.000001, 3.000001), Vec2(3.999999, 3.000001), Vec2(3.999999, 3.999999)},

   ["face_vertex_count"] = {3, 3, 3, 3,
			    3, 3, 3, 3,
			    3, 3, 3, 3,
			    3, 3, 3, 3},
   ["is_subd"] = false,
}

GeometrySet("Scene/geometrySet") {
    planeGeom,
    triGeom
}

Layer("/Scene/layer") {
    {planeGeom, "", checkerMtl, lightSet},
    {triGeom, "", checkerMtl, lightSet}
}

BakeCamera("/Scene/rendering/camera") {
   ["node_xform"] = translate(0, .75, 3),
   ["geometry"] = planeGeom,
   ["mode"] = 0, -- camera
   ["bias"] = 0.001,
   ["udim"] = 1002,
   ["near"] = .0001,
   ["far"] = 1
}

