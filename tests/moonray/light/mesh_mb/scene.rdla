rats_assets_dir = os.getenv("RATS_ASSETS_DIR")

SceneVariables {
    ["image_width"] = 200,
    ["image_height"] = 200,
    ["pixel_samples"] = 4,
}

cam = PerspectiveCamera("cam") {
    ["node_xform"] = rotate(-5, 0, 1, 0) * translate(0, 0, 12) * rotate(-30, 1, 0, 0);
    ["mb_shutter_open"] = -1,
    ["mb_shutter_close"] = 0,
}

cube = RdlMeshGeometry("cube") {
    ["vertex_list_0"] = {
        Vec3(-1,-1,-1),
        Vec3( 1,-1,-1),
        Vec3(-1, 1,-1),
        Vec3( 1, 1,-1),
        Vec3(-1,-1, 1),
        Vec3( 1,-1, 1),
        Vec3(-1, 1, 1),
        Vec3( 1, 1, 1)
    },
    ["vertex_list_1"] = {
        Vec3( 3,-1,-1),
        Vec3( 5,-1,-1),
        Vec3( 3, 1,-1),
        Vec3( 5, 1,-1),
        Vec3( 3,-1, 1),
        Vec3( 5,-1, 1),
        Vec3( 3, 1, 1),
        Vec3( 5, 1, 1)
    },
    ["velocity_list_0"] = {
        Vec3(0, 100, 0),
        Vec3(0, 100, 0),
        Vec3(0, 100, 0),
        Vec3(0, 100, 0),
        Vec3(0, 100, 0),
        Vec3(0, 100, 0),
        Vec3(0, 100, 0),
        Vec3(0, 100, 0)
    },
    ["velocity_list_1"] = {
        Vec3(100, 100, 0),
        Vec3(100, 100, 0),
        Vec3(100, 100, 0),
        Vec3(100, 100, 0),
        Vec3(100, 100, 0),
        Vec3(100, 100, 0),
        Vec3(100, 100, 0),
        Vec3(100, 100, 0)
    },
    ["vertices_by_index"] = {
        0,1,3,2, 
        4,5,7,6, 
        0,1,5,4,
        3,2,6,7,
        0,2,6,4,
        1,3,7,5
    },
    ["face_vertex_count"] = { 4, 4, 4, 4, 4, 4 },
    ["is_subd"] = false,
    ["motion_blur_type"] = "hermite",
    ["side_type"] = "force single-sided",
}

floor = UsdGeometry("floor") {
    ["node_xform"] = scale(100, 100, 100) * translate(0, -2, 0),
    ["stage"] = rats_assets_dir.."/models/plane.usdc",
    ["prim_path"] = "/plane",
}

GeometrySet("geom") { cube, floor }

mtlFloor = DwaSolidDielectricMaterial("mtlFloor") { }

texture = ImageMap("texture") {
    ["texture"] = rats_assets_dir.."/textures/color_grid.tx",
}

mesh = MeshLight("/Scene/lighting/mesh") {
    ["node_xform"] = blur(rotate(30, 0, 0, 1),
                          rotate(0, 0, 0, 1) * translate(0, 1, 0) * scale(0.8, 0.8, 0.8)),
    ["visible_in_camera"] = 1,
    ["mb"] = true,
    ["geometry"] = cube,
    ["normalized"] = false,
    ["map_shader"] = texture,
}

lgts = LightSet("lgts") { mesh }

layer = Layer("defaultLayer") {
    { floor, "", mtlFloor, lgts },
}
