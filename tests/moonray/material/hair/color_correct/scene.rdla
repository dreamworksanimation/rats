SceneVariables {
    ["image_width"] = 400,
    ["image_height"] = 400,
    ["pixel_samples"] = 4,
}

PerspectiveCamera("camera") {
    ["node_xform"] = translate(0, 0.25, 12),
}

env = EnvLight("env") {
    ["intensity"] = 0.7,
    ["texture"] = rats_assets_dir .. "/hdri/parkinglot_dusk.exr",
}

key = RectLight("/Scene/lighting/key") {
    ["node_xform"] = translate(0, 0, 270) * rotate(-40, 1, 0, 0) * rotate(-60, 0, 1, 0),
    ["intensity"] = 70,
    ["normalized"] = false,
    ["color"] = Rgb(0.855, 0.77, 0.535),
    ["width"] = 80,
    ["height"] = 80,
}

lightSet = LightSet("lightSet") {
    env, key,
}

lock1 = UsdGeometry("lock1") {
    ["node_xform"] = translate(-3, 2, 0),
    ["stage"] = rats_assets_dir .. "/models/hair_lock.usdc",
    ["prim_path"] = "/hair",
}

lock2 = UsdGeometry("lock2") {
    ["node_xform"] = translate(-1, 2, 0),
    ["stage"] = rats_assets_dir .. "/models/hair_lock.usdc",
    ["prim_path"] = "/hair",
}

lock3 = UsdGeometry("lock3") {
    ["node_xform"] = translate(1, 2, 0),
    ["stage"] = rats_assets_dir .. "/models/hair_lock.usdc",
    ["prim_path"] = "/hair",
}

lock4 = UsdGeometry("lock4") {
    ["node_xform"] = translate(3, 2, 0),
    ["stage"] = rats_assets_dir .. "/models/hair_lock.usdc",
    ["prim_path"] = "/hair",
}

hair1 = UsdGeometry("hair1") {
    ["node_xform"] = translate(-3, -2, 0),
    ["stage"] = rats_assets_dir .. "/models/hair_curly.usdc",
    ["prim_path"] = "/hair",
}

hair2 = UsdGeometry("hair2") {
    ["node_xform"] = translate(-1, -2, 0),
    ["stage"] = rats_assets_dir .. "/models/hair_curly.usdc",
    ["prim_path"] = "/hair",
}

hair3 = UsdGeometry("hair3") {
    ["node_xform"] = translate(1, -2, 0),
    ["stage"] = rats_assets_dir .. "/models/hair_curly.usdc",
    ["prim_path"] = "/hair",
}

hair4 = UsdGeometry("hair4") {
    ["node_xform"] = translate(3, -2, 0),
    ["stage"] = rats_assets_dir .. "/models/hair_curly.usdc",
    ["prim_path"] = "/hair",
}

GeometrySet("geometryset") {
    lock1, lock2, lock3, lock4,
    hair1, hair2, hair3, hair4,
}

hairMtl1 = HairMaterial_v3("/Scene/surfacing/hairAlbinoMtl") {
    ["hair_color"] = Rgb(0.552000, 0.567000, 0.582000),
    ["primary_specular_roughness"] = 0.15,
    ["primary_specular_offset"] = -3.0,
    ["independent_secondary_specular_roughness"] = 0.5,
    ["secondary_specular_offset"] = 4.5,
    ["transmission_azimuthal_roughness"] = 1,
}

hairAlbinoMtl = HairColorCorrectMaterial("/Scene/surfacing/haitMtl1") {
    ["input_hair_material"] = hairMtl1,
    ["gain"] = 0
}

hairMtl2 = HairMaterial_v3("/Scene/surfacing/hair2") {
    ["hair_color"] = Rgb(0.351, 0.275, 0.15),
    ["primary_specular_roughness"] = 0.6,
    ["primary_specular_offset"] = -10.0,
}

hairBlondMtl = HairColorCorrectMaterial("/Scene/surfacing/hairMtl2") {
    ["input_hair_material"] = hairMtl2,
    ["hue_shift"] = 0.5,
    ["gain"] = 1
}

hairLayer = HairLayerMaterial("/Scene/surfacing//hairLayer") {
    ["hair_material_A"] = hairBlondMtl,
    ["hair_material_B"] = hairAlbinoMtl,
    ["mask"] = 1
}

hairBrownMtl = HairColorCorrectMaterial("/Scene/surfacing/hair3") {
    ["input_hair_material"] = hairLayer,
    ["saturation"] = 2,
    ["hue_shift"] = 0.8
}

hair4Mtl = HairDiffuseMaterial("/Scene/surfacing/hair4") {
    ["hair_color"] = Rgb(0.119000, 0.01000, 0.00001),
}

hairRedMtl = HairColorCorrectMaterial("/Scene/surfacing/hairRedMtl") {
    ["input_hair_material"] = hair4Mtl,
    ["gain"] = 4 
}

Layer("layer") {
    {lock1, "", hairAlbinoMtl, lightSet},
    {lock2, "", hairBlondMtl, lightSet},
    {lock3, "", hairBrownMtl, lightSet},
    {lock4, "", hairRedMtl, lightSet},
    {hair1, "", hairAlbinoMtl, lightSet},
    {hair2, "", hairBlondMtl, lightSet},
    {hair3, "", hairBrownMtl, lightSet},
    {hair4, "", hairRedMtl, lightSet},
}
