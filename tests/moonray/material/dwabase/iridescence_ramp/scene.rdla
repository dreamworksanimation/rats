rats_assets_dir = os.getenv("RATS_ASSETS_DIR")


SceneVariables {
    ["pixel_samples"] = 2,
    ["light_samples"] = 1,
    ["max_depth"] = 2,
    ["image_width"] = 540,
    ["image_height"] = 320,
}

Camera("/Scene/rendering/camera") {
    ["node_xform"] = translate(0, 1.5, 40) * rotate(-10, 1, 0, 0),
    ["focal"] = 100,
}

-------------------------------------------------------

env = EnvLight("/Scene/lighting/env") {
    ["intensity"] = 0.8,
    ["texture"] = rats_assets_dir .. "/hdri/parkinglot_dusk.exr",
}

key = RectLight("/Scene/lighting/key") {
    ["node_xform"] = translate(0, 0, 100) *
                     rotate(-60, 1, 0, 0) *
                     rotate(-60, 0, 1, 0),
    ["intensity"] = 12,
    ["color"] = Rgb(0.855, 0.77, 0.535),
    ["width"] = 50,
    ["height"] = 50,
}

lightSet = LightSet("/Scene/lighting/lightSet") {
    env,
    key,
}

---------- GEOMETRY ----------
local sphere1 = SphereGeometry("/Scene/geometry/sphere1") {
    ["node_xform"] = translate(-3, 3, 0),
}

local sphere2 = SphereGeometry("/Scene/geometry/sphere2") {
    ["node_xform"] = translate(0, 3, 0),
}

local sphere3 = SphereGeometry("/Scene/geometry/sphere3") {
    ["node_xform"] = translate(3, 3, 0),
}

local sphere4 = SphereGeometry("/Scene/geometry/sphere4") {
    ["node_xform"] = translate(0, 0, 0),
}

local sphere5 = SphereGeometry("/Scene/geometry/sphere5") {
    ["node_xform"] = translate(3, 0, 0),
}

local sphere6 = SphereGeometry("/Scene/geometry/sphere6") {
    ["node_xform"] = translate(-3, 0, 0),
    ["side_type"] = 0,
}

----------- MATERIALS ------------
local defaultsMtl = DwaBaseMaterial("/Scene/surfacing/defaultsMtl") {
    ["iridescence"] = 1,
    ["iridescence_color_control"] = 1, -- use ramp
    ["iridescence_thickness"] = 5,
    ["roughness"] = 0,
    ["show_diffuse"] = false,
    ["metallic"] = 1.0,
    ["metallic_color"] = Rgb(0.5, 0.48, 0.49),
}

local defaultsHsvMtl = DwaBaseMaterial("/Scene/surfacing/defaultsHsvMtl") {
    ["iridescence"] = 1,
    ["iridescence_color_control"] = 1, -- use ramp
    ["iridescence_ramp_interpolation_mode"] = 1, -- HSV
    ["iridescence_thickness"] = 5,
    ["roughness"] = 0,
    ["show_diffuse"] = false,
    ["metallic"] = 1.0,
    ["metallic_color"] = Rgb(0.5, 0.48, 0.49),
}

local desatMtl = DwaBaseMaterial("/Scene/surfacing/desatMtl") {
    ["iridescence"] = 1,
    ["iridescence_color_control"] = 1, -- use ramp
    ["iridescence_positions"] = {0, 0.25, 1},
    ["iridescence_colors"] = {Rgb(0.3, 0.3, 0.1), Rgb(0.1, 0.0167, 0.025), Rgb(0.3, 0.3, 0.1)},
    ["iridescence_thickness"] = 5,
    ["roughness"] = 0,
    ["show_diffuse"] = false,
    ["metallic"] = 1.0,
    ["metallic_color"] = Rgb(0.5, 0.48, 0.49),
}

local twoColorsMtl = DwaBaseMaterial("/Scene/surfacing/twoColorsMtl") {
    ["iridescence"] = 1,
    ["iridescence_color_control"] = 1, -- use ramp
    ["iridescence_positions"] = {0, 0.5, 1},
    ["iridescence_colors"] = {Rgb(0, 1, 0), Rgb(0, 0, 1), Rgb(0, 1, 0)},
    ["iridescence_thickness"] = 5,
    ["roughness"] = 0,
    ["show_diffuse"] = false,
    ["metallic"] = 1.0,
    ["metallic_color"] = Rgb(0.5, 0.48, 0.49),
}

local twoColorsHsvMtl = DwaBaseMaterial("/Scene/surfacing/twoColorsHsvMtl") {
    ["iridescence"] = 1,
    ["iridescence_color_control"] = 1, -- use ramp
    ["iridescence_ramp_interpolation_mode"] = 1, -- HSV
    ["iridescence_positions"] = {0, 0.5, 1},
    ["iridescence_colors"] = {Rgb(0, 1, 0), Rgb(0, 0, 1), Rgb(0, 1, 0)},
    ["iridescence_thickness"] = 5,
    ["roughness"] = 0,
    ["show_diffuse"] = false,
    ["metallic"] = 1.0,
    ["metallic_color"] = Rgb(0.5, 0.48, 0.49),
}

local interpolationMtl = DwaBaseMaterial("/Scene/surfacing/interpolationMtl") {
    ["iridescence"] = 1,
    ["iridescence_color_control"] = 1, -- use ramp
    ["iridescence_positions"] = {0, 0.5, 1},
    ["iridescence_colors"] = {Rgb(0, 1, 0), Rgb(0, 0, 1), Rgb(0, 1, 0)},
    ["iridescence_interpolations"] = {1, 0, 0},
    ["iridescence_thickness"] = 5,
    ["roughness"] = 0,
    ["show_diffuse"] = false,
    ["metallic"] = 1.0,
    ["metallic_color"] = Rgb(0.5, 0.48, 0.49),
}

-------------------------------------------------------
GeometrySet("Scene/geometrySet") {
    sphere1,
    sphere2,
    sphere3,
    sphere4,
    sphere5,
    sphere6,
}
Layer("/Scene/layer") {
    {sphere1, "", defaultsMtl, lightSet},
    {sphere2, "", defaultsHsvMtl, lightSet},
    {sphere3, "", desatMtl, lightSet},
    {sphere4, "", twoColorsMtl, lightSet},
    {sphere5, "", twoColorsHsvMtl, lightSet},
    {sphere6, "", interpolationMtl, lightSet},
}

