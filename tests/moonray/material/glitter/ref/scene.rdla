rats_assets_dir = os.getenv("RATS_ASSETS_DIR")

SceneVariables {
    ["pixel_samples"] = 3,
    ["max_depth"] = 0,
    ["image_width"] = 512,
    ["image_height"] = 256,
}

local camera = Camera("/Scene/rendering/camera") {
    ["node_xform"] = translate(0, 0, 1.3),
}

-- Geometry --
refSphere = UsdGeometry("refSphere") {
    ["node_xform"] = scale(0.15, 0.15, 0.15) * rotate(-90, 0, 0, 1) * translate(0.35, 0.0, 0),
    ["stage"] = rats_assets_dir .. "/models/sphere.usdc",
    ["prim_path"] = "/sphere",
}

refSphere2 = UsdGeometry("refSphere2") {
    ["node_xform"] = scale(0.15, 0.15, 0.15) * translate(-0.0, 0., 0),
    ["stage"] = rats_assets_dir .. "/models/sphere.usdc",
    ["prim_path"] = "/sphere",
}

refSphere3 = UsdGeometry("refSphere3") {
    ["node_xform"] = scale(0.15, 0.15, 0.15) * rotate(90, 0, 0, 1) * translate(-0.35, 0., 0),
    ["stage"] = rats_assets_dir .. "/models/sphere.usdc",
    ["prim_path"] = "/sphere",
}

GeometrySet("geometryset") {
    refSphere,
    refSphere2,
    refSphere3
}

-- Materials --

local glitter = DwaBaseMaterial("/Scene/surfacing/obj_sphere_right") {
    ["albedo"] = Rgb(0.35, 0.10, 0.10),
    ["glitter_color_A"] = Rgb(0.55, 0.13, 0.18),
    ["glitter_seed"] = 18721,
    ["glitter_color_hue_variation"] = 0.4,
    ["glitter_density"] = 3,
    ["glitter_randomness"] = 0.0,
    ["glitter_roughness_A"] = 0.1,
    ["glitter_size_A"] = 0.15,
    ["glitter_space"] = 5,
    ["glitter"] = 1.0,
    ["show_glitter"] = true,
    ["show_specular"] = false,
    ["show_diffuse"] = false,
}

-- Lights --

EnvLight("/Scene/lighting/env") {
    ["exposure"] = -0.5,
    ["sample_upper_hemisphere_only"] = false,
    ["visible_in_camera"] = false,
}

LightSet("LightSetA") {
    EnvLight("/Scene/lighting/env"),
    RectLight("/Scene/lighting/rect"),
}

Layer("/Scene/rendering/organizer/perPartitionAssignments") {
    {refSphere, "", glitter, LightSet("LightSetA")},
    {refSphere2, "", glitter, LightSet("LightSetA")},
    {refSphere3, "", glitter, LightSet("LightSetA")},
}
