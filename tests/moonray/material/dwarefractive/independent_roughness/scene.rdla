rats_assets_dir = os.getenv("RATS_ASSETS_DIR")

SceneVariables {
    ["image_width"] = 350,
    ["image_height"] = 250,
    ["pixel_samples"] = 2,
    ["bsdf_samples"] = 3,
    ["max_depth"] = 3,
}

Camera("/Scene/rendering/camera") {
    ["node_xform"] = translate(0, 0, 10.5) *
                     translate(0, 0.6, 0),
}

-------------------------------------------------------

env = EnvLight("/Scene/lighting/env") {
    ["exposure"] = 0.0,
    ["visible_in_camera"] = 1,
    ["texture"] = rats_assets_dir .. "/hdri/parkinglot_dusk.exr",
}

key = RectLight("/Scene/lighting/key") {
    ["node_xform"] = translate(0, 0, 100) * rotate(-60, 1, 0, 0) * rotate(-60, 0, 1, 0),
    ["intensity"] = 12,
    ["exposure"] = 0.0,
    ["color"] = Rgb(0.855, 0.77, 0.535),
    ["width"] = 50,
    ["height"] = 50,
}

lightSet = LightSet("/Scene/lighting/lightSet") {
    env,
    key,
}

-------------------------------------------------------

local geom1 = SphereGeometry("/Scene/geometry/geom1") { ["node_xform"] = translate(-3.0,  2.0, 0.0), }
local geom2 = SphereGeometry("/Scene/geometry/geom2") { ["node_xform"] = translate( 0.0,  2.0, 0.0), }
local geom3 = SphereGeometry("/Scene/geometry/geom3") { ["node_xform"] = translate( 3.0,  2.0, 0.0), }
local geom4 = SphereGeometry("/Scene/geometry/geom4") { ["node_xform"] = translate(-1.5, -0.8, 0.0), }
local geom5 = SphereGeometry("/Scene/geometry/geom5") { ["node_xform"] = translate( 1.5, -0.8, 0.0), }

-------------------------------------------------------

local mtl1 = DwaRefractiveMaterial("/Scene/surfacing/mtl1") {
    ["roughness"] = 0.3,
    ["use_independent_transmission_roughness"] = true,
    ["independent_transmission_roughness"] = 0.1,
}

local mtl2 = DwaRefractiveMaterial("/Scene/surfacing/mtl2") {
    ["show_clearcoat"] = true,    
    ["clearcoat_roughness"] = 0.1,
    ["roughness"] = 0.1,
    ["use_independent_transmission_roughness"] = true,
    ["independent_transmission_roughness"] = 0.5,
}

local mtl3 = DwaRefractiveMaterial("/Scene/surfacing/mtl3") {
    ["show_clearcoat"] = true,    
    ["clearcoat_roughness"] = 0.1,
    ["roughness"] = 0.3,
    ["use_independent_transmission_roughness"] = true,
    ["independent_transmission_roughness"] = 0.1,
}

local basemtl1 = DwaBaseMaterial("/Scene/surfacing/basemtl1") {
    ["albedo"] = Rgb(1, 0, 0),
    ["transmission"] = 0.5,
    ["roughness"] = 0.1,
    ["independent_transmission_roughness"] = 0.1,
    ["use_independent_transmission_roughness"] = true,
}

local basemtl2 = DwaBaseMaterial("/Scene/surfacing/basemtl2") {
    ["albedo"] = Rgb(1, 0, 0),
    ["transmission"] = 0.5,
    ["roughness"] = 0.1,
    ["independent_transmission_roughness"] = 0.1,
    ["use_independent_transmission_roughness"] = false,
}

-------------------------------------------------------

GeometrySet("Scene/geometrySet") {
    geom1,
    geom2,
    geom3,
    geom4,
    geom5
}

Layer("/Scene/layer") {
    {geom1, "", mtl1, lightSet},
    {geom2, "", mtl2, lightSet},
    {geom3, "", mtl3, lightSet},
    {geom4, "", basemtl1, lightSet},
    {geom5, "", basemtl2, lightSet},
}

