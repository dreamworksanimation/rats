SceneVariables {
    ["image_width"] = 500,
    ["image_height"] = 300,
    ["pixel_samples"] = 3,
    ["max_depth"] = 1,
}

Camera("/Scene/rendering/camera") {
    ["node_xform"] = translate(0.0, 0.0, 1.9) *
                     rotate(-25.0, 1.0, 0.0, 0.0) *
                     translate(0.25, 0.4, 0.0),
}

rectLight = RectLight("rectLight") {
    ["intensity"] = 0.02,
    ["node_xform"] = translate(0.0, 0.0, 5.0) *
                     rotate(-30.0, 1.0, 0.0, 0.0) *
                     rotate(70.0, 0.0, 1.0, 0.0),
}

lights = LightSet("/Scene/lights/lightset") {
    rectLight
}

grid = UsdGeometry("/scene/geometry/floor") {
    ["node_xform"] = scale(100, 100, 100),
    ["stage"] = rats_assets_dir.."/models/plane.usdc",
    ["prim_path"] = "/plane",
}

colorData = UserData("colorData") {
    ["color_key"] = "Cd",
    ["color_values_0"] = { 
        Rgb(1.0, 0.0, 0.0),
        Rgb(0.0, 1.0, 0.0),
        Rgb(0.0, 0.0, 1.0),
    },
}

normalData = UserData("normalData") {
    ["vec3f_key"] = "normal",
    ["vec3f_values_0"] = { 
        Vec3(1.0, 0.0, 0.0),
        Vec3(1.0, 0.0, 0.0),
        Vec3(0.0, 0.0, 1.0),
        Vec3(0.0, 0.0, 1.0),
        Vec3(1.0, 0.0, 0.0),
        Vec3(1.0, 0.0, 0.0),

        Vec3(-1.0, 0.0, 0.5),
        Vec3(-1.0, 0.0, 0.5),
        Vec3(-1.0, 0.0, 0.5),
        Vec3(0.0, 0.0, 1.0),
        Vec3(0.0, 0.0, 1.0),
        Vec3(0.0, 0.0, 1.0),

        Vec3(1.0, 0.0, 0.0),
        Vec3(1.0, 0.0, 0.0),
        Vec3(0.0, 0.0, 1.0),
        Vec3(0.0, 0.0, 1.0),
        Vec3(1.0, 0.0, 0.0),
        Vec3(1.0, 0.0, 0.0),
    },
}

curves1 = RdlCurveGeometry("curves1") {
    ["node_xform"] = translate(-0.3, 0.0, 0.0),
    ["curve_type"] = "bspline",
    ["curves_subtype"] = "normal_oriented",
    ["tessellation_rate"] = 12,
    ["curves_vertex_count"] = { 6, 6, 6 },
    ["vertex_list_0"] = {
        Vec3(0.2, 0.0, 0.0),
        Vec3(0.2, 0.0, 0.0),
        Vec3(-0.2, 0.25, 0.0),
        Vec3(0.2, 0.5, 0.0),
        Vec3(-0.2, 0.75, 0.0),
        Vec3(0.2, 1.0, 0.0),

        Vec3(0.25, 0.0, 0.0),
        Vec3(0.25, 0.0, 0.0),
        Vec3(0.25, 0.25, 0.25),
        Vec3(0.25, 0.5, -0.25),
        Vec3(0.25, 0.75, 0.25),
        Vec3(0.25, 1.0, -0.25),

        Vec3(0.5, 0.0, 0.0),
        Vec3(0.5, 0.0, 0.0),
        Vec3(0.7, 0.25, -0.4),
        Vec3(0.5, 0.5, 0.0),
        Vec3(0.5, 0.75, -0.4),
        Vec3(0.9, 1.0, 0.0),
    },
    ["radius_list"] = {
        0.03, 0.04, 0.05
    },
    ["primitive_attributes"] = { colorData, normalData },
}

normalData2 = UserData("normalData2") {
    ["vec3f_key"] = "normal",
    ["vec3f_values_0"] = { 
        Vec3(1.0, 0.0, 1.0),
        Vec3(0.0, 0.0, 1.0),
        Vec3(-1.0, 0.0, 1.0),
    },
}

curves2 = RdlCurveGeometry("curves2") {
    ["node_xform"] = translate(0.75, 0.0, 0.0),
    ["curve_type"] = "bezier",
    ["curves_subtype"] = "normal_oriented",
    ["tessellation_rate"] = 12,
    ["curves_vertex_count"] = { 7, 7, 7 },
    ["vertex_list_0"] = {
        Vec3(-0.2, 0.0, 0.0),
        Vec3(-0.2, 0.1, 0.0),
        Vec3(-0.3, 0.2, 0.0),
        Vec3(-0.3, 0.3, 0.0),
        Vec3(-0.3, 0.5, 0.0),
        Vec3(-0.2, 0.6, 0.2),
        Vec3(-0.2, 0.8, 0.2),

        Vec3(0.0, 0.0, -0.1),
        Vec3(0.0, 0.1, -0.1),
        Vec3(0.0, 0.2, 0.0),
        Vec3(0.0, 0.3, 0.0),
        Vec3(0.0, 0.4, 0.0),
        Vec3(0.0, 0.5, -0.1),
        Vec3(0.0, 0.6, -0.1),

        Vec3(0.2, 0.0, 0.0),
        Vec3(0.2, 0.1, 0.0),
        Vec3(0.2, 0.2, 0.0),
        Vec3(0.2, 0.3, 0.0),
        Vec3(0.2, 0.4, 0.0),
        Vec3(0.0, 0.5, 0.4),
        Vec3(0.0, 0.6, 0.4),
    },
    ["radius_list"] = {
        0.07,
        0.03,
        0.02,
        0.01,
        0.03,
        0.04,
        0.06,

        0.1,
        0.04,
        0.03,
        0.02,
        0.01,
        0.005,
        0.0,

        0.1,
        0.1,
        0.01,
        0.01,
        0.01,
        0.05,
        0.05,
    },
    ["primitive_attributes"] = { colorData, normalData2 },
}

GeometrySet("/Scene/geometry/all") {
    grid,
    curves1,
    curves2,
}

attrMapCd = AttributeMap("attrMapCd") {
}

curvesMtl = DwaSolidDielectricMaterial("curvesMtl") {
    ["show_diffuse"] = true,
    ["show_specular"] = true,
    ["albedo"] = bind(attrMapCd, Rgb(0.1, 0.1, 0.1)),
    ["roughness"] = 0.2,
    ["thin_geometry"] = true,

}

gridMtl = DwaSolidDielectricMaterial("gridMtl") {
    ["show_specular"] = false,
}

Layer("/Scene/rendering/all") {
    {grid, "", gridMtl, lights},
    {curves1, "", curvesMtl, lights},
    {curves2, "", curvesMtl, lights},
}
